{"version":3,"file":"index.es.js","sources":["../node_modules/style-inject/dist/style-inject.es.js","../src/index.js"],"sourcesContent":["function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nimport styles from './styles.css';\n\nconst KEY_CODE = {\n  backspace: 8,\n  left: 37,\n  up: 38,\n  right: 39,\n  down: 40\n};\n\nexport default class ReactCodeInput extends Component {\n  static propTypes = {\n    type: PropTypes.oneOf(['text', 'number']),\n    onChange: PropTypes.func,\n    onComplete: PropTypes.func,\n    fields: PropTypes.number,\n    loading: PropTypes.bool,\n    title: PropTypes.string,\n    fieldWidth: PropTypes.number,\n    fieldHeight: PropTypes.number,\n    autoFocus: PropTypes.bool,\n    className: PropTypes.string,\n    values: PropTypes.arrayOf(PropTypes.string)\n  };\n\n  static defaultProps = {\n    type: 'number',\n    fields: 6,\n    fieldWidth: 58,\n    fieldHeight: 54,\n    autoFocus: true\n  };\n\n  constructor(props) {\n    super(props);\n    const { fields, values } = props;\n    let vals;\n    let autoFocusIndex = 0;\n    if (values && values.length) {\n      vals = [];\n      for (let i = 0; i < fields; i++) {\n        vals.push(values[i] || '');\n      }\n      autoFocusIndex = values.length >= fields ? 0 : values.length;\n    } else {\n      vals = Array(fields).fill('');\n    }\n    this.state = { values: vals, autoFocusIndex };\n\n    this.iRefs = [];\n    for (let i = 0; i < fields; i++) {\n      this.iRefs.push(React.createRef());\n    }\n    this.id = +new Date();\n\n    // this.handleKeys = Array(fields).fill(false);\n  }\n\n  /**\n   * Clear all field value & focus first field\n   */\n  __clearvalues__ = () => {\n    const { fields } = this.props;\n    this.setState({ values: Array(fields).fill('') });\n    this.iRefs[0].current.focus();\n  };\n\n  triggerChange = (values = this.state.values) => {\n    const { onChange, onComplete, fields } = this.props;\n    const val = values.join('');\n    onChange && onChange(val);\n    if (onComplete && val.length >= fields) {\n      onComplete(val);\n    }\n  };\n\n  onChange = e => {\n    const index = parseInt(e.target.dataset.id);\n    if (this.props.type === 'number') {\n      e.target.value = e.target.value.replace(/[^\\d]/gi, '');\n    }\n    // this.handleKeys[index] = false;\n    if (e.target.value === '' || (this.props.type === 'number' && !e.target.validity.valid)) {\n      return;\n    }\n    const { fields } = this.props;\n    let next;\n    const value = e.target.value;\n    let { values } = this.state;\n    values = Object.assign([], values);\n    if (value.length > 1) {\n      let nextIndex = value.length + index - 1;\n      if (nextIndex >= fields) {\n        nextIndex = fields - 1;\n      }\n      next = this.iRefs[nextIndex];\n      const split = value.split('');\n      split.forEach((item, i) => {\n        const cursor = index + i;\n        if (cursor < fields) {\n          values[cursor] = item;\n        }\n      });\n      this.setState({ values });\n    } else {\n      next = this.iRefs[index + 1];\n      values[index] = value;\n      this.setState({ values });\n    }\n\n    if (next) {\n      next.current.focus();\n      next.current.select();\n    }\n\n    this.triggerChange(values);\n  };\n\n  onKeyDown = e => {\n    const index = parseInt(e.target.dataset.id);\n    const prevIndex = index - 1;\n    const nextIndex = index + 1;\n    const prev = this.iRefs[prevIndex];\n    const next = this.iRefs[nextIndex];\n    switch (e.keyCode) {\n      case KEY_CODE.backspace:\n        e.preventDefault();\n        const vals = [...this.state.values];\n        if (this.state.values[index]) {\n          vals[index] = '';\n          this.setState({ values: vals });\n          this.triggerChange(vals);\n        } else if (prev) {\n          vals[prevIndex] = '';\n          prev.current.focus();\n          this.setState({ values: vals });\n          this.triggerChange(vals);\n        }\n        break;\n      case KEY_CODE.left:\n        e.preventDefault();\n        if (prev) {\n          prev.current.focus();\n        }\n        break;\n      case KEY_CODE.right:\n        e.preventDefault();\n        if (next) {\n          next.current.focus();\n        }\n        break;\n      case KEY_CODE.up:\n      case KEY_CODE.down:\n        e.preventDefault();\n        break;\n      default:\n        // this.handleKeys[index] = true;\n        break;\n    }\n  };\n\n  // onKeyUp = e => {\n  //   const index = parseInt(e.target.dataset.id);\n  //   if (this.handleKeys[index]) {\n  //     this.handleKeys[index] = false;\n  //     const next = this.iRefs[index + 1];\n  //     if (next) {\n  //       next.current.focus();\n  //     }\n  //   }\n  // };\n\n  onFocus = e => {\n    e.target.select(e);\n  };\n\n  render() {\n    const { values, autoFocusIndex } = this.state;\n    const {\n      loading,\n      title,\n      fieldHeight,\n      fieldWidth,\n      fields,\n      autoFocus,\n      className,\n      type\n    } = this.props;\n    const INPUT_STYLE = {\n      width: fieldWidth,\n      height: fieldHeight\n    };\n    const ROOT_STYLE = {\n      width: fields * fieldWidth\n    };\n    const LOADING_STYLE = {\n      lineHeight: `${fieldHeight}px`\n    };\n    return (\n      <div\n        className={`${styles['react-code-input-container']} ${className}`}\n        style={ROOT_STYLE}\n      >\n        {title && <p className={styles['title']}>{title}</p>}\n        <div className={styles['react-code-input']}>\n          {values.map((value, index) => (\n            <input\n              type={type === 'number' ? 'tel' : type}\n              pattern={type === 'number' ? '[0-9]' : null}\n              autoFocus={autoFocus && index === autoFocusIndex}\n              style={INPUT_STYLE}\n              key={`${this.id}-${index}`}\n              data-id={index}\n              value={value}\n              ref={this.iRefs[index]}\n              onChange={this.onChange}\n              onKeyDown={this.onKeyDown}\n              // onKeyUp={this.onKeyUp}\n              onFocus={this.onFocus}\n            />\n          ))}\n        </div>\n        {loading && (\n          <div className={styles['loading']} style={LOADING_STYLE}>\n            <div className={styles['blur']} />\n            <svg\n              className={styles['spin']}\n              viewBox=\"0 0 1024 1024\"\n              data-icon=\"loading\"\n              width=\"1em\"\n              height=\"1em\"\n              fill=\"currentColor\"\n              aria-hidden=\"true\"\n            >\n              <path\n                fill=\"#006fff\"\n                d=\"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 0 0-94.3-139.9 437.71 437.71 0 0 0-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z\"\n              />\n            </svg>\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n"],"names":["KEY_CODE","ReactCodeInput","props","fields","values","vals","autoFocusIndex","length","i","push","Array","fill","state","iRefs","React","createRef","id","Date","loading","title","fieldHeight","fieldWidth","autoFocus","className","type","INPUT_STYLE","ROOT_STYLE","LOADING_STYLE","styles","map","value","index","onChange","onKeyDown","onFocus","Component","propTypes","PropTypes","oneOf","func","number","bool","string","arrayOf","defaultProps","__clearvalues__","setState","current","focus","triggerChange","onComplete","val","join","parseInt","e","target","dataset","replace","validity","valid","next","Object","assign","nextIndex","split","forEach","item","cursor","select","prevIndex","prev","keyCode","backspace","preventDefault","left","right","up","down"],"mappings":"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"}